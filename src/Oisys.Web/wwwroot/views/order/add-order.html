<add-edit-shell>
    <shell-title>
        <h3>
            Save Order Details.
            <small class="text-muted">
                <i class="fa fa-info-circle text-primary"></i>
                To add new order details, click the <code>New order detail</code> button.
            </small>
        </h3>
    </shell-title>
    <shell-form>
        <form name="addOrderForm">
            <div class="col-md-3 left-padding-none">
                <div form-input>
                    <label>Order Number</label>
                    <input type="text" ng-model="ctrl.order.code" focus-me="ctrl.defaultFocus" />
                </div>
                <div form-input>
                    <label>Customer</label>
                    <select ng-model="ctrl.order.customerId" ng-options="customer.id as customer.name for customer in ctrl.customerList"></select>
                </div>
            </div>
            <div class="col-md-3 left-padding-none">
                <div form-input>
                    <label>Order Date</label>
                    <input type="date" ng-model="ctrl.order.date" />
                </div>
                <div form-input>
                    <label>Due Date</label>
                    <input type="date" ng-model="ctrl.order.dueDate" />
                </div>
            </div>
            <div class="col-md-3 left-padding-none">
                <div>
                    <label class="control-label">Discount</label>
                    <discount-control discount-percent="ctrl.order.discountPercent" discount-amount="ctrl.order.discountAmount"></discount-control>
                </div>
                <div form-input>
                    <label>Total Amount</label>
                    <input type="text" ng-model="ctrl.order.totalAmount" numeric-textbox="{ currencySymbol: '₱ '}" readonly />
                </div>
            </div>
            <div class="col-md-10 left-padding-none">
                <table class="table table-condensed input-details-table">
                    <thead>
                        <tr>
                            <th style="width: 26%;">Item</th>
                            <th style="width: 15%;">Quantity</th>
                            <th style="width: 15%;">Unit</th>
                            <th style="width: 20%;">Unit Price</th>
                            <th style="width: 20%;">Total Price</th>
                            <th style="width: 4%;"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="6">
                                <button class="btn btn-primary btn-xs" ng-click="ctrl.addOrderDetail()">
                                    <i class="fa fa-plus"></i> New order detail
                                </button>
                            </td>
                        </tr>
                        <tr ng-repeat="i in ctrl.orderDetails track by $index">
                            <td>
                                <div ng-if="!i.isDeleted">
                                    <select class="form-control input-sm" ng-model="i.selectedItem" ng-options="item.codeName for item in ctrl.itemList" focus-me="i.focus"></select>
                                </div>
                                <div ng-if="i.isDeleted">
                                    <s>{{ i.selectedItem.codeName }}</s>
                                </div>
                            </td>
                            <td>
                                <div ng-if="!i.isDeleted">
                                    <input class="form-control input-sm" type="number" ng-model="i.quantity" />
                                </div>
                                <div ng-if="i.isDeleted">
                                    <s>{{ i.quantity }}</s>
                                </div>
                            </td>
                            <td>
                                <div ng-if="!i.isDeleted">
                                    <input class="form-control input-sm" ng-model="i.unit" readonly />
                                </div>
                                <div ng-if="i.isDeleted">
                                    <s>{{ i.unit }}</s>
                                </div>
                            </td>
                            <td>
                                <div ng-if="!i.isDeleted">
                                    <price-toggler item="i.selectedItem" selected-price-type="walkInPrice" selected-price="i.price"></price-toggler>
                                </div>
                                <div ng-if="i.isDeleted">
                                    <s>₱ {{ i.price | number: 2 }}</s>
                                </div>
                            </td>
                            <td>
                                <div ng-if="!i.isDeleted">
                                    <input type="text" class="form-control input-sm" ng-model="i.totalPrice"
                                           numeric-textbox="{ currencySymbol: '₱ '}" readonly />
                                </div>
                                <div ng-if="i.isDeleted">
                                    <s>₱ {{ i.totalPrice | number: 2 }}</s>
                                </div>
                            </td>
                            <td>
                                <div ng-if="!i.isDeleted">
                                    <a href="" class="text-danger" ng-click="ctrl.removeOrderDetail($index)">
                                        <i class="fa fa-times"></i>
                                    </a>
                                </div>
                                <div ng-if="i.isDeleted">
                                    <a href="" class="text-success" ng-click="ctrl.undoRemove($index)">
                                        <i class="fa fa-undo"></i>
                                    </a>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </form>
    </shell-form>
</add-edit-shell>