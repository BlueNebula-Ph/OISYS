<add-edit-shell>
    <shell-title>
        <h3>Save Delivery. <small>{{ ctrl.label }}</small></h3>
    </shell-title>
    <shell-form>
        <form name="ctrl.addDeliveryForm">
            <div class="col-md-3 left-padding-none">
                <div form-input>
                    <label>Province</label>
                    <select ng-options="province.id as province.name for province in ctrl.provinceList"
                            ng-model="ctrl.delivery.provinceId" focus-me="ctrl.defaultFocus"></select>
                </div>
            </div>
            <div class="col-md-3 left-padding-none">
                <div form-input>
                    <label>City</label>
                    <select ng-options="city.id as city.name for city in ctrl.citiesList" ng-model="ctrl.delivery.cityId"></select>
                </div>
            </div>
            <div class="col-md-3 left-padding-none">
                <div form-input>
                    <label>Plate Number</label>
                    <input type="text" ng-model="ctrl.delivery.plateNumber" />
                </div>
            </div>
            <div class="col-md-3 left-padding-none">
                <div form-input>
                    <label>Date</label>
                    <input type="date" ng-model="ctrl.delivery.date" />
                </div>
            </div>
            <div class="col-md-8 left-padding-none">
                <table class="table table-condensed input-details-table">
                    <thead>
                        <tr>
                            <th colspan="4" class="header-actions">
                                <button ng-click="ctrl.addDeliveryDetail()" class="header-action-button">
                                    <i class="fa fa-plus"></i> Delivery Items
                                </button>
                            </th>
                        </tr>
                        <tr>
                            <th style="width: 35%;">Customer</th>
                            <th style="width: 35%;">Item</th>
                            <th class="text-right" style="width: 20%;">Quantity</th>
                            <th style="width: 10%;"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="detail in ctrl.delivery.details track by $index" ng-if="!detail.isDeleted" ng-include="'edit'"></tr>
                        <tr no-records ng-if="ctrl.delivery.details.length == 0" colspan="4"></tr>
                    </tbody>
                </table>
            </div>
            <div class="col-md-4 left-padding-none">
                <div class="delivery-summary-box">
                    <label>Summary</label>
                    <table class="table">
                        <thead>
                            <tr>
                                <td>Item</td>
                                <td>Quantity</td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-if="ctrl.delivery.summary.length == 0"><td colspan="2">No summary to display.</td></tr>
                            <tr ng-repeat="summary in ctrl.delivery.summary track by $index">
                                <td>{{ summary.itemCodeName }}</td>
                                <td>{{ summary.totalQuantity }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="delivery-summary-box totals">
                    <label>Totals</label>
                    <ul class="list-unstyled">
                        <li ng-if="ctrl.delivery.totals.length == 0">No totals to display.</li>
                        <li ng-repeat="total in ctrl.delivery.totals track by $index">{{ total.description }}</li>
                    </ul>
                </div>
            </div>
        </form>
    </shell-form>
    <shell-controls>
        <save-button on-save="ctrl.save()" is-saving="ctrl.isSaving" is-disabled="!ctrl.addDeliveryForm.$valid || ctrl.addDeliveryForm.$pristine"></save-button>
    </shell-controls>
</add-edit-shell>

<script type="text/ng-template" id="edit">
    <td><select class="form-control input-xs" ng-options="customer.id as customer.name for customer in ctrl.customerList" ng-model="detail.customerId"></select></td>
    <td><select class="form-control input-xs" ng-options="orderDetail.itemCodeNameOrder for orderDetail in detail.customerOrders" ng-model="detail.selectedOrderDetail"></select></td>
    <td><input class="form-control input-xs text-right" type="number" ng-model="detail.quantity" max="{{ detail.max }}" /></td>
    <td class="text-center">
        <button ng-click="ctrl.deleteDetail(detail)" class="table-action-button red"><i class="fa fa-trash"></i></button>
    </td>
</script>